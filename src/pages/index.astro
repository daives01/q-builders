---
import Layout from '../layouts/Layout.astro';
import { config } from '../config';
import Hero from '../components/Hero.astro';
---

<Layout>
	<nav id="navbar" class="fixed top-0 left-0 right-0 z-50 transition-all duration-[var(--transition-medium)] transform -translate-y-full" aria-label="Main navigation">
		<div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
			<a href="#hero" class="text-xl font-semibold tracking-tight text-white hover:text-white/80 transition-colors">Q Builders</a>
			<div class="flex items-center gap-3 md:gap-6">
				{['about', 'gallery', 'testimonials', 'contact'].map((section) => (
					<a href={`#${section}`} class="nav-link text-white/70 hover:text-white text-xs md:text-sm tracking-wide transition-colors" aria-label={`Navigate to ${section}`}>
						{section.charAt(0).toUpperCase() + section.slice(1)}
					</a>
				))}
				<a href={`mailto:${config.hero.email}`} class="text-white/90 hover:text-white text-xs md:text-sm tracking-wide transition-colors" aria-label="Send email to Q Builders">
					Get in Touch
				</a>
			</div>
		</div>
	</nav>

	<main class="scroll-smooth snap-y snap-mandatory overflow-y-scroll overflow-x-hidden">
		<Hero />

		<section id="about" class="relative py-24 md:py-32 px-6 snap-start min-h-screen md:min-h-[100dvh]" aria-labelledby="about-heading">
			<div class="max-w-7xl mx-auto">
				<div class="backdrop-blur-xl bg-stone-900/60 rounded-2xl p-8 md:p-16 shadow-xl">
					<div class="grid lg:grid-cols-2 gap-16 items-center">
						<div class="order-2 lg:order-1">
							<p class="text-amber-500 tracking-[0.2em] uppercase text-sm font-semibold mb-4">
								About
							</p>
							<h2 id="about-heading" class="text-4xl md:text-5xl lg:text-6xl font-bold text-white tracking-tight mb-6 leading-tight">
								{config.about.name}
							</h2>
							<p class="text-lg text-stone-300 leading-relaxed mb-10">
								{config.about.bio}
							</p>
							<dl class="grid grid-cols-2 md:grid-cols-3 gap-8">
								{config.about.stats.map((stat) => (
									<div>
										<dt class="text-4xl md:text-5xl font-bold text-white mb-2 tracking-tight">
											{stat.value}
										</dt>
										<dd class="text-sm text-stone-400 uppercase tracking-wider">
											{stat.label}
										</dd>
									</div>
								))}
							</dl>
						</div>
					<div class="relative order-1 lg:order-2">
						<picture class="relative block rounded-lg overflow-hidden">
							<source srcset={config.about.photo} type="image/jpeg" />
							<img src={config.about.photo} alt={config.about.name} class="w-full h-[400px] md:h-[600px] object-cover" loading="lazy" />
						</picture>
					</div>
				</div>
				</div>
			</div>
		</section>

		<section id="gallery" class="relative py-24 md:py-32 px-6 snap-start min-h-screen md:min-h-[100dvh]" aria-labelledby="gallery-heading">
			<div class="relative z-10 max-w-7xl mx-auto">
				<div class="text-center md:text-center mb-16">
					<p class="text-amber-600 tracking-[0.2em] uppercase text-sm font-semibold mb-4">
						Gallery
					</p>
					<h2 id="gallery-heading" class="text-4xl md:text-5xl lg:text-6xl font-bold text-white tracking-tight">
						My work
					</h2>
				</div>
				<div class="hidden md:block">
					<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 auto-rows-[280px]">
						{config.gallery.map((image, index) => {
							const pattern = index % 6;
							const mdSpans = pattern === 0 ? 'md:col-span-2 md:row-span-2' :
							               pattern === 1 ? 'md:col-span-1 md:row-span-1' :
							               pattern === 2 ? 'md:col-span-1 md:row-span-1' :
							               pattern === 3 ? 'md:col-span-2 md:row-span-1' :
							               pattern === 4 ? 'md:col-span-1 md:row-span-1' :
							               'md:col-span-1 md:row-span-1';
							const lgSpans = pattern === 0 ? 'lg:col-span-2 lg:row-span-2' :
							               pattern === 1 ? 'lg:col-span-1 lg:row-span-2' :
							               pattern === 2 ? 'lg:col-span-2 lg:row-span-1' :
							               pattern === 3 ? 'lg:col-span-1 lg:row-span-1' :
							               pattern === 4 ? 'lg:col-span-1 lg:row-span-1' :
							               'lg:col-span-2 lg:row-span-1';
							const heights = pattern === 0 ? 'h-[580px]' :
							               pattern === 1 ? 'h-[580px]' :
							               pattern === 2 ? 'h-[280px]' :
							               pattern === 3 ? 'h-[280px]' :
							               pattern === 4 ? 'h-[280px]' :
							               'h-[280px]';

							return (
								<figure class:list={[`group relative overflow-hidden`, mdSpans, lgSpans]}>
									<picture>
										<source srcset={image.src} type="image/jpeg" />
										<img src={image.src} alt={image.alt} loading="lazy" class:list={['w-full object-cover transition-transform duration-[var(--transition-slow)]', heights]} />
									</picture>
								</figure>
							);
						})}
					</div>
				</div>
				<div class="md:hidden flex flex-col items-center justify-center gap-6 min-h-[50vh] px-4">
					<a href="/gallery" class="inline-flex items-center gap-3 bg-white hover:bg-white/90 text-stone-900 font-semibold px-8 py-4 rounded-[var(--radius-md)] transition-all duration-[var(--transition-fast)] tracking-wide">
						<span>View Gallery</span>
						<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
						</svg>
					</a>
					<p class="text-white/90 text-center max-w-2xl min-w-[320px] px-4">
						A few examples of our work around Denver
					</p>
				</div>
			</div>
		</section>

		<section id="testimonials" class="relative py-24 md:py-32 px-6 snap-start min-h-screen md:min-h-[100dvh]" aria-labelledby="testimonials-heading">
			<div class="max-w-7xl mx-auto">
				<div class="backdrop-blur-xl bg-stone-900/60 rounded-2xl p-8 md:p-16 shadow-xl">
					<div class="text-center mb-16">
					<p class="text-amber-500 tracking-[0.2em] uppercase text-sm font-semibold mb-4">
						Testimonials
					</p>
					<h2 id="testimonials-heading" class="text-4xl md:text-5xl lg:text-6xl font-bold text-white tracking-tight">
						Client Stories
					</h2>
				</div>
				<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
					{config.testimonials.map((testimonial) => (
						<figure class="bg-stone-800 p-8 hover:bg-stone-700 transition-colors duration-[var(--transition-fast)]">
							<blockquote class="text-stone-300 leading-relaxed mb-6 text-lg font-light">
								"{testimonial.quote}"
							</blockquote>
							<figcaption>
								<div class="text-white font-semibold mb-1">
									{testimonial.name}
								</div>
								<div class="text-stone-500 text-sm">
									{testimonial.neighborhood}
								</div>
							</figcaption>
						</figure>
					))}
				</div>
				</div>
			</div>
		</section>

		<section id="contact" class="relative py-24 md:py-32 px-6 snap-start min-h-screen md:min-h-[100dvh] flex items-center" aria-labelledby="contact-heading">
			<div class="max-w-7xl mx-auto w-full text-center">
				<p class="text-amber-600 tracking-[0.2em] uppercase text-sm font-semibold mb-4">
					Get Started
				</p>
				<h2 id="contact-heading" class="text-4xl md:text-5xl lg:text-6xl font-bold text-white tracking-tight mb-6">
					{config.contact.headline}
				</h2>
				<p class="text-lg md:text-xl text-white/90 mb-10 leading-relaxed max-w-5xl md:max-w-6xl mx-auto">
					{config.contact.description}
				</p>
				<a href={`mailto:${config.hero.email}`} class="inline-flex items-center gap-3 bg-white hover:bg-white/90 text-stone-900 font-semibold px-10 py-5 rounded-[var(--radius-md)] transition-all duration-[var(--transition-fast)] tracking-wide group" aria-label={`Send email to ${config.hero.email}`}>
					<span>{config.hero.email}</span>
					<svg class="w-5 h-5 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
					</svg>
				</a>
			</div>
		</section>
	</main>

	<script>
		const navbar = document.getElementById('navbar');
		const sections = document.querySelectorAll('section[id]');
		const navLinks = document.querySelectorAll('.nav-link');
		let ticking = false;

		const updateUI = () => {
			const scrollY = window.scrollY || window.pageYOffset;

			if (navbar) {
				if (scrollY > 100) {
					navbar.classList.remove('-translate-y-full');
					navbar.classList.add('translate-y-0', 'bg-stone-900/95', 'backdrop-blur-[var(--backdrop-blur)]');
				} else {
					navbar.classList.add('-translate-y-full');
					navbar.classList.remove('translate-y-0', 'bg-stone-900/95', 'backdrop-blur-[var(--backdrop-blur)]');
				}
			}

			if (sections.length && navLinks.length) {
				sections.forEach((section) => {
					const sectionTop = (section as HTMLElement).offsetTop;
					const sectionHeight = (section as HTMLElement).offsetHeight;
					const sectionId = section.getAttribute('id');

					if (scrollY >= sectionTop - 300 && scrollY < sectionTop + sectionHeight - 300) {
						navLinks.forEach((link) => {
							if (link.getAttribute('href') === `#${sectionId}`) {
								link.classList.add('text-white');
							} else {
								link.classList.remove('text-white');
							}
						});
					}
				});
			}

			ticking = false;
		};

		const onScroll = () => {
			if (!ticking) {
				window.requestAnimationFrame(updateUI);
				ticking = true;
			}
		};

		document.addEventListener('DOMContentLoaded', () => {
			window.addEventListener('scroll', onScroll, { passive: true });
		});
	</script>
</Layout>
